<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>TS (Transport Stream) | Studios</title><meta name="description" content="">
    <link rel="preload" href="/2023/assets/style-af81738b.css" as="style"><link rel="stylesheet" href="/2023/assets/style-af81738b.css">
    <link rel="modulepreload" href="/2023/assets/app-8d1f7407.js"><link rel="modulepreload" href="/2023/assets/framework-5866ffd3.js"><link rel="modulepreload" href="/2023/assets/ts.html-164efd40.js"><link rel="modulepreload" href="/2023/assets/ts.html-7a3e86a4.js"><link rel="prefetch" href="/2023/assets/index.html-7f7a0c3f.js" as="script"><link rel="prefetch" href="/2023/assets/Reference.html-62bf0884.js" as="script"><link rel="prefetch" href="/2023/assets/express.js.html-57e95e66.js" as="script"><link rel="prefetch" href="/2023/assets/koa.js.html-139b5782.js" as="script"><link rel="prefetch" href="/2023/assets/next.js.html-5c76bb25.js" as="script"><link rel="prefetch" href="/2023/assets/node.js.html-9a866051.js" as="script"><link rel="prefetch" href="/2023/assets/socket.io.html-1f3cfc7f.js" as="script"><link rel="prefetch" href="/2023/assets/cbplayer.html-9706f7fe.js" as="script"><link rel="prefetch" href="/2023/assets/clappr.html-aaf6c260.js" as="script"><link rel="prefetch" href="/2023/assets/dplayer.html-c965bdc3.js" as="script"><link rel="prefetch" href="/2023/assets/plyr.html-1e89d56a.js" as="script"><link rel="prefetch" href="/2023/assets/video.js.html-0bf587fd.js" as="script"><link rel="prefetch" href="/2023/assets/xgplayer.html-6f0838b2.js" as="script"><link rel="prefetch" href="/2023/assets/hls.js.html-6ae3bfa5.js" as="script"><link rel="prefetch" href="/2023/assets/playwright.html-baa3b880.js" as="script"><link rel="prefetch" href="/2023/assets/puppeteer.html-700e8b32.js" as="script"><link rel="prefetch" href="/2023/assets/testCafe.html-88b7ea79.js" as="script"><link rel="prefetch" href="/2023/assets/docker.html-1a1f0c5f.js" as="script"><link rel="prefetch" href="/2023/assets/elastic.html-a21aaf45.js" as="script"><link rel="prefetch" href="/2023/assets/grafana.html-ada9ede2.js" as="script"><link rel="prefetch" href="/2023/assets/jenkins.html-7fa480b2.js" as="script"><link rel="prefetch" href="/2023/assets/nginx.html-226d46f4.js" as="script"><link rel="prefetch" href="/2023/assets/redis.html-2e066c5a.js" as="script"><link rel="prefetch" href="/2023/assets/webAssembly.html-e951b9a5.js" as="script"><link rel="prefetch" href="/2023/assets/webAssemblyStepByStep.html-fb9c99b9.js" as="script"><link rel="prefetch" href="/2023/assets/webPlayerKernel.html-f0775f0d.js" as="script"><link rel="prefetch" href="/2023/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/2023/assets/index.html-9285cfdf.js" as="script"><link rel="prefetch" href="/2023/assets/Reference.html-e815d83b.js" as="script"><link rel="prefetch" href="/2023/assets/express.js.html-21fb61b3.js" as="script"><link rel="prefetch" href="/2023/assets/koa.js.html-fcee0a7c.js" as="script"><link rel="prefetch" href="/2023/assets/next.js.html-a35fdb2b.js" as="script"><link rel="prefetch" href="/2023/assets/node.js.html-63e986b8.js" as="script"><link rel="prefetch" href="/2023/assets/socket.io.html-554ed8f3.js" as="script"><link rel="prefetch" href="/2023/assets/cbplayer.html-607c8d40.js" as="script"><link rel="prefetch" href="/2023/assets/clappr.html-44b7cafb.js" as="script"><link rel="prefetch" href="/2023/assets/dplayer.html-89edbe09.js" as="script"><link rel="prefetch" href="/2023/assets/plyr.html-dbcaa34c.js" as="script"><link rel="prefetch" href="/2023/assets/video.js.html-45836c46.js" as="script"><link rel="prefetch" href="/2023/assets/xgplayer.html-82cefeff.js" as="script"><link rel="prefetch" href="/2023/assets/hls.js.html-c6f46c8b.js" as="script"><link rel="prefetch" href="/2023/assets/playwright.html-66476130.js" as="script"><link rel="prefetch" href="/2023/assets/puppeteer.html-65f9d9ed.js" as="script"><link rel="prefetch" href="/2023/assets/testCafe.html-71bdf01f.js" as="script"><link rel="prefetch" href="/2023/assets/docker.html-5300e7ed.js" as="script"><link rel="prefetch" href="/2023/assets/elastic.html-9025cfbb.js" as="script"><link rel="prefetch" href="/2023/assets/grafana.html-81c7bec7.js" as="script"><link rel="prefetch" href="/2023/assets/jenkins.html-905e298a.js" as="script"><link rel="prefetch" href="/2023/assets/nginx.html-f723be8f.js" as="script"><link rel="prefetch" href="/2023/assets/redis.html-2f01ca07.js" as="script"><link rel="prefetch" href="/2023/assets/webAssembly.html-85f18239.js" as="script"><link rel="prefetch" href="/2023/assets/webAssemblyStepByStep.html-31736f20.js" as="script"><link rel="prefetch" href="/2023/assets/webPlayerKernel.html-adf32b57.js" as="script"><link rel="prefetch" href="/2023/assets/404.html-87d54bd8.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/2023/" class=""><!----><span class="site-name">Studios</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading active">WebAssembly + FFmpeg <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/2023/webAssembly/webAssembly.html" class="sidebar-item" aria-label="WebAssembly"><!--[--><!--]--> WebAssembly <!--[--><!--]--></a><!----></li><li><a href="/2023/webAssembly/webAssemblyStepByStep.html" class="sidebar-item" aria-label="WebAssembly step-by-step"><!--[--><!--]--> WebAssembly step-by-step <!--[--><!--]--></a><!----></li><li><a href="/2023/webAssembly/webPlayerKernel.html" class="sidebar-item" aria-label="Web Player Kernel"><!--[--><!--]--> Web Player Kernel <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2023/webAssembly/ts.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="TS (Transport Stream)"><!--[--><!--]--> TS (Transport Stream) <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/2023/webAssembly/ts.html#ts-stream" class="router-link-active router-link-exact-active sidebar-item" aria-label="TS Stream"><!--[--><!--]--> TS Stream <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2023/webAssembly/ts.html#the-role-of-pid" class="router-link-active router-link-exact-active sidebar-item" aria-label="The role of PID"><!--[--><!--]--> The role of PID <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2023/webAssembly/ts.html#ts-class" class="router-link-active router-link-exact-active sidebar-item" aria-label="TS Class"><!--[--><!--]--> TS Class <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/2023/webAssembly/ts.html#class-members" class="router-link-active router-link-exact-active sidebar-item" aria-label="Class Members"><!--[--><!--]--> Class Members <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/2023/webAssembly/ts.html#class-heritage" class="router-link-active router-link-exact-active sidebar-item" aria-label="Class Heritage"><!--[--><!--]--> Class Heritage <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Node <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/2023/node/node.js.md" class="sidebar-item" aria-label="Node.js"><!--[--><!--]--> Node.js <!--[--><!--]--></a><!----></li><li><a href="/2023/node/express.js.md" class="sidebar-item" aria-label="Express.js"><!--[--><!--]--> Express.js <!--[--><!--]--></a><!----></li><li><a href="/2023/node/koa.js.md" class="sidebar-item" aria-label="Koa.js"><!--[--><!--]--> Koa.js <!--[--><!--]--></a><!----></li><li><a href="/2023/node/next.js.md" class="sidebar-item" aria-label="Next.js"><!--[--><!--]--> Next.js <!--[--><!--]--></a><!----></li><li><a href="/2023/node/socket.io.md" class="sidebar-item" aria-label="Socket.io"><!--[--><!--]--> Socket.io <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">HLS <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/2023/hls/hls.js.md" class="sidebar-item" aria-label="Hls.js"><!--[--><!--]--> Hls.js <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Player <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/2023/player/video.js.md" class="sidebar-item" aria-label="Video.js"><!--[--><!--]--> Video.js <!--[--><!--]--></a><!----></li><li><a href="/2023/player/xgplayer.md" class="sidebar-item" aria-label="Xgplayer"><!--[--><!--]--> Xgplayer <!--[--><!--]--></a><!----></li><li><a href="/2023/player/plyr.md" class="sidebar-item" aria-label="Plyr"><!--[--><!--]--> Plyr <!--[--><!--]--></a><!----></li><li><a href="/2023/player/clappr.md" class="sidebar-item" aria-label="Clappr"><!--[--><!--]--> Clappr <!--[--><!--]--></a><!----></li><li><a href="/2023/player/dplayer.md" class="sidebar-item" aria-label="DPlayer"><!--[--><!--]--> DPlayer <!--[--><!--]--></a><!----></li><li><a href="/2023/player/cbplayer.md" class="sidebar-item" aria-label="CBPlayer"><!--[--><!--]--> CBPlayer <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Testing <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/2023/testing/playwright.md" class="sidebar-item" aria-label="Playwright"><!--[--><!--]--> Playwright <!--[--><!--]--></a><!----></li><li><a href="/2023/testing/puppeteer.md" class="sidebar-item" aria-label="Puppeteer"><!--[--><!--]--> Puppeteer <!--[--><!--]--></a><!----></li><li><a href="/2023/testing/testCafe.md" class="sidebar-item" aria-label="TestCafe"><!--[--><!--]--> TestCafe <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">DevOps <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/2023/devops/nginx.md" class="sidebar-item" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a><!----></li><li><a href="/2023/devops/docker.md" class="sidebar-item" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a><!----></li><li><a href="/2023/devops/redis.md" class="sidebar-item" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a><!----></li><li><a href="/2023/devops/elastic.md" class="sidebar-item" aria-label="Elastic"><!--[--><!--]--> Elastic <!--[--><!--]--></a><!----></li><li><a href="/2023/devops/grafana.md" class="sidebar-item" aria-label="Grafana"><!--[--><!--]--> Grafana <!--[--><!--]--></a><!----></li><li><a href="/2023/devops/jenkins.md" class="sidebar-item" aria-label="Jenkins"><!--[--><!--]--> Jenkins <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/2023/Reference.html" class="sidebar-item sidebar-heading" aria-label="Reference"><!--[--><!--]--> Reference <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="ts-transport-stream" tabindex="-1"><a class="header-anchor" href="#ts-transport-stream" aria-hidden="true">#</a> TS (Transport Stream)</h1><p>Let&#39;s talk about the TS (Transport Stream) protocol format. The HLS (HTTP Live Streaming) protocol is a live broadcast protocol launched by Apple as a replacement for the RTMP (Real-Time Messaging Protocol) protocol.</p><p>This agreement uses HTTP as the underlying transport protocol, and the transmitted data includes:</p><ul><li><code>M3U8</code> File - is used to record which TS fragments can be played.</li><li><code>TS</code> Fragment File - records the media data or metadata that needs to be played within a short period of time (such as 10 seconds).</li></ul><p>In the TS fragment file, the video data encoding format can be H.264, H.265, and so on, while the audio format can be MP3, AAC, and so on.</p><h2 id="ts-stream" tabindex="-1"><a class="header-anchor" href="#ts-stream" aria-hidden="true">#</a> TS Stream</h2><p>In live streaming, the player downloads individual TS segments to enable the continuous playback of audio and video streams. Therefore, people also refer to these continuous TS segments as TS streams.</p><p>From the diagram, we can understand that:</p><ul><li>A TS stream is composed of individual TS segments.</li><li>Each TS segment is made up of multiple TS packets.</li><li>Each TS packet includes a header and payload.</li><li>The header specifies the type of data stored in the payload.</li><li>The payload contains the specific type of data indicated by the header.</li><li>The payload can either be PSI (Program Specific Information) metadata or audio/video data.</li></ul><p>The HLS (HTTP Live Streaming) protocol introduced by Apple has streamlined the types of PSI/SI data in the MPEG2 specification, retaining only the two most fundamental types of PSI data: the Program Association Table (PAT) and the Program Map Table (PMT).</p><p>The PAT is used to indicate the PID (Program ID) used by the PMT, while the PMT is used to indicate the PIDs used by the audio and video streams.&quot;</p><h2 id="the-role-of-pid" tabindex="-1"><a class="header-anchor" href="#the-role-of-pid" aria-hidden="true">#</a> The role of PID</h2><h2 id="ts-class" tabindex="-1"><a class="header-anchor" href="#ts-class" aria-hidden="true">#</a> TS Class</h2><p>TypeScript offers full support for the class keyword introduced in ES2015.</p><p>As with other JavaScript language features, TypeScript adds type annotations and other syntax to allow you to express relationships between classes and other types.</p><h3 id="class-members" tabindex="-1"><a class="header-anchor" href="#class-members" aria-hidden="true">#</a> Class Members</h3><p>Here’s the most basic class - an empty one:</p><div class="language-typescript" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>This class isn’t very useful yet, so let’s start adding some members.</p><h4 id="fields" tabindex="-1"><a class="header-anchor" href="#fields" aria-hidden="true">#</a> Fields</h4><p>A field declaration creates a public writeable property on a class:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pt<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
pt<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As with other locations, the type annotation is optional, but will be an implicit any if not specified.</p><p>Fields can also have initializers; these will run automatically when the class is instantiated:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Prints 0, 0</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pt<span class="token punctuation">.</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pt<span class="token punctuation">.</span>y<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Just like with <code>const</code>, <code>let</code>, and <code>var</code>, the initializer of a class property will be used to infer its type:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> pt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
pt<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// Type &#39;string&#39; is not assignable to type &#39;number&#39;.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="strictpropertyinitialization" tabindex="-1"><a class="header-anchor" href="#strictpropertyinitialization" aria-hidden="true">#</a> --strictPropertyInitialization</h5><p>The strictPropertyInitialization setting controls whether class fields need to be initialized in the constructor.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">BadGreeter</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">// Property &#39;name&#39; has no initializer and is not definitely assigned in the constructor.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">GoodGreeter</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
 
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Note that the field needs to be initialized in the constructor itself. TypeScript does not analyze methods you invoke from the constructor to detect initializations, because a derived class might override those methods and fail to initialize the members.</p><p>If you intend to definitely initialize a field through means other than the constructor (for example, maybe an external library is filling in part of your class for you), you can use the definite assignment assertion operator, !:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">OKGreeter</span> <span class="token punctuation">{</span>
  <span class="token comment">// Not initialized, but no error</span>
  name<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="readonly" tabindex="-1"><a class="header-anchor" href="#readonly" aria-hidden="true">#</a> readonly</h4><p>Fields may be prefixed with the readonly modifier. This prevents assignments to the field outside of the constructor.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
  <span class="token keyword">readonly</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
 
  <span class="token function">constructor</span><span class="token punctuation">(</span>otherName<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>otherName <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> otherName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
 
  <span class="token function">err</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;not ok&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// Cannot assign to &#39;name&#39; because it is a read-only property.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> g <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
g<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;also not ok&quot;</span><span class="token punctuation">;</span>
<span class="token comment">// Cannot assign to &#39;name&#39; because it is a read-only property.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="constructors" tabindex="-1"><a class="header-anchor" href="#constructors" aria-hidden="true">#</a> Constructors</h4><p>Class constructors are very similar to functions. You can add parameters with type annotations, default values, and overloads:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  y<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
 
  <span class="token comment">// Normal signature with defaults</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">=</span> x<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">=</span> y<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  <span class="token comment">// Overloads</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>xs<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> y<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// TBD</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There are just a few differences between class constructor signatures and function signatures:</p><ul><li>Constructors can’t have type parameters - these belong on the outer class declaration, which we’ll learn about later</li><li>Constructors can’t have return type annotations - the class instance type is always what’s returned</li></ul><h4 id="super-calls" tabindex="-1"><a class="header-anchor" href="#super-calls" aria-hidden="true">#</a> Super Calls</h4><p>Just as in JavaScript, if you have a base class, you’ll need to call super(); in your constructor body before using any this. members:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  k <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name">Derived</span> <span class="token keyword">extends</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Prints a wrong value in ES5; throws exception in ES6</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// &#39;super&#39; must be called before accessing &#39;this&#39; in the constructor of a derived class.</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Forgetting to call <code>super</code> is an easy mistake to make in JavaScript, but TypeScript will tell you when it’s necessary.</p><h4 id="methods" tabindex="-1"><a class="header-anchor" href="#methods" aria-hidden="true">#</a> Methods</h4><p>A function property on a class is called a method. Methods can use all the same type annotations as functions and constructors:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
  x <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
  y <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
 
  <span class="token function">scale</span><span class="token punctuation">(</span>n<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>x <span class="token operator">*=</span> n<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>y <span class="token operator">*=</span> n<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Other than the standard type annotations, TypeScript doesn’t add anything else new to methods.</p><p>Note that inside a method body, it is still mandatory to access fields and other methods via this.. An unqualified name in a method body will always refer to something in the enclosing scope:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
<span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  x<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
 
  <span class="token function">m</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// This is trying to modify &#39;x&#39; from line 1, not the class property</span>
    x <span class="token operator">=</span> <span class="token string">&quot;world&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// Type &#39;string&#39; is not assignable to type &#39;number&#39;.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="getters-setters" tabindex="-1"><a class="header-anchor" href="#getters-setters" aria-hidden="true">#</a> Getters / Setters</h4><p>Classes can also have accessors:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name"><span class="token constant">C</span></span> <span class="token punctuation">{</span>
  _length <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_length<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">set</span> <span class="token function">length</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_length <span class="token operator">=</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>TypeScript has some special inference rules for accessors:</p><ul><li>If <code>get</code> exists but no <code>set</code>, the property is automatically <code>readonly</code></li><li>If the type of the setter parameter is not specified, it is inferred from the return type of the getter</li><li>Getters and setters must have the same <code>Member Visibility</code></li></ul><p>Since TypeScript 4.3, it is possible to have accessors with different types for getting and setting.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">Thing</span> <span class="token punctuation">{</span>
  _size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
 
  <span class="token keyword">get</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_size<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token keyword">set</span> <span class="token function">size</span><span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token comment">// Don&#39;t allow NaN, Infinity, etc</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Number<span class="token punctuation">.</span><span class="token function">isFinite</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">this</span><span class="token punctuation">.</span>_size <span class="token operator">=</span> num<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="index-signatures" tabindex="-1"><a class="header-anchor" href="#index-signatures" aria-hidden="true">#</a> Index Signatures</h4><p>Classes can declare index signatures; these work the same as <code>Index Signatures for other object types</code>:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">class</span> <span class="token class-name">MyClass</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
  <span class="token function">check</span><span class="token punctuation">(</span>s<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span>s<span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Because the index signature type needs to also capture the types of methods, it’s not easy to usefully use these types. Generally it’s better to store indexed data in another place instead of on the class instance itself.</p><h3 id="class-heritage" tabindex="-1"><a class="header-anchor" href="#class-heritage" aria-hidden="true">#</a> Class Heritage</h3><p>Like other languages with object-oriented features, classes in JavaScript can inherit from base classes.</p><h4 id="implements-clauses" tabindex="-1"><a class="header-anchor" href="#implements-clauses" aria-hidden="true">#</a> implements Clauses</h4><p>You can use an implements clause to check that a class satisfies a particular interface. An error will be issued if a class fails to correctly implement it:</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Pingable</span> <span class="token punctuation">{</span>
  <span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name">Sonar</span> <span class="token keyword">implements</span> <span class="token class-name">Pingable</span> <span class="token punctuation">{</span>
  <span class="token function">ping</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;ping!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name">Ball</span> <span class="token keyword">implements</span> <span class="token class-name">Pingable</span> <span class="token punctuation">{</span>
  <span class="token comment">// Class &#39;Ball&#39; incorrectly implements interface &#39;Pingable&#39;.</span>
  <span class="token comment">// Property &#39;ping&#39; is missing in type &#39;Ball&#39; but required in type &#39;Pingable&#39;.</span>
  <span class="token function">pong</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;pong!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Classes may also implement multiple interfaces, e.g. class C implements A, B {.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/2023/webAssembly/webPlayerKernel.html" class="" aria-label="Web Player Kernel"><!--[--><!--]--> Web Player Kernel <!--[--><!--]--></a></span><!----></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/2023/assets/app-8d1f7407.js" defer></script>
  </body>
</html>
